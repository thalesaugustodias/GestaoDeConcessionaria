@model GestaoDeConcessionaria.Web.Models.ConcessionariaViewModel
@{
    ViewData["Title"] = "Cadastrar Concessionária";
}

<section class="content-header">
    <div class="container-fluid">
        <div class="row mb-2">
            <div class="col-sm-6">
                <h1>
                    <i class="fas fa-building mr-2"></i>
                    Cadastrar Concessionária
                </h1>
            </div>
            <div class="col-sm-6">
                <a asp-action="Index" class="btn btn-secondary float-right">
                    <i class="fas fa-arrow-left mr-1"></i>
                    Voltar
                </a>
            </div>
        </div>
    </div>
</section>

<section class="content">
    <div class="container-fluid">
        <div class="card">
            <div class="card-header bg-primary">
                <h3 class="card-title">
                    <i class="fas fa-plus-circle mr-1"></i>
                    Nova Concessionária
                </h3>
            </div>
            <form asp-action="Create" method="post" id="formConcessionaria">
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label asp-for="Nome">
                                    <i class="fas fa-store mr-1"></i>
                                    Nome da Concessionária
                                </label>
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">
                                            <i class="fas fa-building"></i>
                                        </span>
                                    </div>
                                    <input asp-for="Nome" class="form-control" placeholder="Digite o nome da concessionária" />
                                </div>
                                <span asp-validation-for="Nome" class="text-danger"></span>
                            </div>

                            <div class="form-group">
                                <label>
                                    <i class="fas fa-map-marked-alt mr-1"></i>
                                    Endereço
                                </label>
                                <div class="input-group mb-3">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">CEP</span>
                                    </div>
                                    <input asp-for="CEP" class="form-control cep-mask" placeholder="00000-000" id="cep" />
                                    <div class="input-group-append">
                                        <button type="button" class="btn btn-info" id="buscarCep">
                                            <i class="fas fa-search"></i>
                                        </button>
                                    </div>
                                </div>
                                <span asp-validation-for="CEP" class="text-danger"></span>

                                <div class="input-group mb-3">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">
                                            <i class="fas fa-road"></i>
                                        </span>
                                    </div>
                                    <input asp-for="Rua" class="form-control" placeholder="Rua" id="rua" />
                                </div>
                                <span asp-validation-for="Rua" class="text-danger"></span>

                                <div class="input-group mb-3">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">
                                            <i class="fas fa-city"></i>
                                        </span>
                                    </div>
                                    <input asp-for="Cidade" class="form-control" placeholder="Cidade" id="cidade" />
                                </div>
                                <span asp-validation-for="Cidade" class="text-danger"></span>

                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">
                                            <i class="fas fa-map"></i>
                                        </span>
                                    </div>
                                    <input asp-for="Estado" class="form-control" placeholder="Estado" id="estado" />
                                </div>
                                <span asp-validation-for="Estado" class="text-danger"></span>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="form-group">
                                <label asp-for="Telefone">
                                    <i class="fas fa-phone mr-1"></i>
                                    Telefone
                                </label>
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">
                                            <i class="fas fa-phone"></i>
                                        </span>
                                    </div>
                                    <input asp-for="Telefone" class="form-control telefone-mask" placeholder="(00) 0000-0000" />
                                </div>
                                <span asp-validation-for="Telefone" class="text-danger"></span>
                            </div>

                            <div class="form-group">
                                <label asp-for="Email">
                                    <i class="fas fa-envelope mr-1"></i>
                                    Email
                                </label>
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">
                                            <i class="fas fa-envelope"></i>
                                        </span>
                                    </div>
                                    <input asp-for="Email" type="email" class="form-control" placeholder="email@exemplo.com" />
                                </div>
                                <span asp-validation-for="Email" class="text-danger"></span>
                            </div>

                            <div class="form-group">
                                <label asp-for="CapacidadeMaximaVeiculos">
                                    <i class="fas fa-car mr-1"></i>
                                    Capacidade Máxima de Veículos
                                </label>
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">
                                            <i class="fas fa-warehouse"></i>
                                        </span>
                                    </div>
                                    <input asp-for="CapacidadeMaximaVeiculos" type="number" class="form-control"
                                           placeholder="Quantidade máxima de veículos" min="1" />
                                </div>
                                <span asp-validation-for="CapacidadeMaximaVeiculos" class="text-danger"></span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card-footer">
                    <div class="float-right">
                        <a asp-action="Index" class="btn btn-secondary">
                            <i class="fas fa-times mr-1"></i>
                            Cancelar
                        </a>
                        <button type="submit" class="btn btn-success" id="btnSalvar">
                            <i class="fas fa-save mr-1"></i>
                            Salvar
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</section>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        $(document).ready(function() {
            $('.cep-mask').mask('00000-000');
            $('.telefone-mask').mask('(00) 0000-0000');
            $("#buscarCep").click(function() {
                var cep = $("#cep").val().replace(/\D/g, '');

                if (cep.length !== 8) {
                    toastr.error('CEP inválido');
                    return;
                }

                $.getJSON(`https://viacep.com.br/ws/${cep}/json/`, function(data) {
                    if (!data.erro) {
                        $("#rua").val(data.logradouro);
                        $("#cidade").val(data.localidade);
                        $("#estado").val(data.uf);
                    } else {
                        toastr.error('CEP não encontrado');
                    }
                }).fail(function() {
                    toastr.error('Erro ao buscar CEP');
                });
            });
            $("#formConcessionaria").on("submit", function() {
                if ($(this).valid()) {
                    $("#btnSalvar")
                        .prop("disabled", true)
                        .html('<i class="fas fa-spinner fa-spin mr-1"></i> Salvando...');
                }
            });
        });
    </script>
}